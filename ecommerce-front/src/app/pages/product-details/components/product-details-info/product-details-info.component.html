    @let product = productDetailsResource.value().data;
    <div class="pt-5 relative">
        <div class="flex h-full justify-between overflow-hidden">
            <!-- Product Images -->
            <div class="z-20 w-full md:w-1/2 px-4 mb-8">
                <div class="border w-[300px] h-[300px] mx-auto rounded-md bg-slate-200 shadow-sm relative">
                    @if(product.quantity === 0) {
                        <span class="absolute left-0 bg-red-600 px-1">Not In Stock</span>
                    }
                    <img
                        [src]="product.images[currentImage]"
                        class="w-full h-full object-cover transition-transform duration-300 ease-in-out hover:scale-110 rounded-lg mb-4" />
                </div>
                @if(visibleImages.length > 1) {
                    <div class="flex gap-4 py-4 justify-center items-center overflow-x-auto">
                        @if(product.images.length > 3) {
                            <i
                                (click)="decrementImageWindow()"
                                [ngClass]="currentIndex === 0 ? 'bg-gray-300 cursor-not-allowed' : 'bg-main-color'"
                                class="cursor-pointer text-white rounded-full fa-solid fa-chevron-left py-1.5 px-2">
                            </i>
                        }
                        @for(image of visibleImages; track image; let idx = $index) {
                        <img
                            (click)="changeCurrentImage(currentIndex+idx)"
                            [ngClass]="currentIndex+idx===currentImage ? 'border opacity-100 shadow-sm': 'opacity-60 '"
                            [src]="image"
                            class="size-16 sm:size-20 object-cover rounded-md cursor-pointer hover:opacity-100 transition duration-300 border-main-color border-solid hover:border" />
                        }
                        @if(product.images.length > 3) {
                            <i 
                                (click)="incrementImageWindow()"
                                class="text-white"
                                [ngClass]="currentIndex + 3 === productDetailsService.productDetailsResource.value().data.images.length ? 'bg-gray-300 cursor-not-allowed' : 'bg-main-color'"
                                class="cursor-pointer text-white rounded-full fa-solid fa-chevron-right py-1.5 px-2">
                            </i>
                        }
                    </div>
                }       
            </div>
            <!-- Product Details -->
            <div class="z-20 w-full flex flex-col md:w-1/2 px-4">
                <ol class="relative flex items-center gap-2 mb-4">
                  <li class="inline-flex gap-1 items-center">
                    <a
                      [routerLink]="['/']"
                      class="cursor-pointer flex items-center text-sm text-gray-500 hover:text-main-color hover:underline">
                      Home
                    </a>
                    <i class="fa-solid fa-chevron-right text-xs text-gray-400"></i>
                  </li>
                  <li class="inline-flex gap-1 items-center">
                    <a
                      [routerLink]="['/categories', product.categorySlug]" 
                      class="cursor-pointer flex items-center text-sm text-gray-500 hover:text-main-color hover:underline">
                      {{product.category}}
                    </a>
                    <i class="fa-solid fa-chevron-right text-xs text-gray-400"></i>
                  </li>
                  <li class="inline-flex items-center text-sm font-semibold text-gray-800 truncate" aria-current="page">
                    {{product.name}}
                  </li>
                </ol>
                <h2 class="text-3xl font-bold mb-2">
                    {{product.name}}
                </h2>
                <div class="flex gap-3 mb-2">
                  <p class="text-gray-600">Brand: {{product.brand}}</p>
                  <p class="text-gray-600">SKU: {{product.sku}}</p>
                </div>
                <a [routerLink]="['/categories', product.categorySlug]" class="text-gray-600 mb-2">
                  Category: <span class="hover:text-main-color hover:underline">{{product.category}}</span>
                </a>
                <p class="text-gray-600 mb-2">
                  In Stock:
                  <span class="font-bold text-main-color">
                    {{product.quantity}}
                  </span>
              </p>
                <div class="flex items-center gap-3 mb-2">
                  <div class="my-4">
                    <span class="px-2 py-1 text-2xl text-main-color rounded border border-main-color font-bold mr-2">
                      $ {{product.price}}
                    </span>
                  </div>
                  <div class="flex gap-1 items-center">
                    @for(currentStar of numberStar; track currentStar) {
                      @if(productDetailsService.avgReview()>=(currentStar+1)) {
                        <i class="w-4 h-4 fa-solid fa-star text-yellow-600"></i>
                      }
                      @else {
                        <i class="w-4 h-4 fa-solid fa-star text-gray-400"></i>
                      }
                    }
                    <span class="ml-2 text-gray-600">
                      {{productDetailsService.avgReview() | number:'1.0-2'}} ({{productDetailsService.reviewsResource.value().data.totalElements}} reviews)
                    </span>
                  </div>
                </div>
                <p class="text-gray-700 mb-6">
                  {{product.description}}
                </p>
                <div class="flex space-x-2">
                    <form [formGroup]="quantityForm" class="flex items-center border-gray-100">
                      <input formControlName="quantity" class="w-8 border h-full bg-white text-center text-xs outline-none rounded-l-md" type="number"  min="1" />
                      <div class="flex flex-col">
                        <span
                          (click)="onIncrementQuantity()"
                          class="cursor-pointer border border-x-0 border-t-0 rounded-tr bg-gray-100 px-3 duration-100 hover:bg-main-color hover:text-blue-50">
                          +
                        </span>
                        <span 
                          (click)="onDecrementQuantity()"
                          class="cursor-pointer border border-x-0 border-t-0  rounded-br bg-gray-100 px-3 duration-100 hover:bg-main-color hover:text-blue-50">
                          -
                        </span>
                      </div>
                    </form>
                    <button
                        (click)="onAddToCart(product)"
                        class="bg-main-color flex gap-2 items-center text-gray-900 px-6 py-2 rounded-md hover:bg-second-color focus:outline-none focus:ring-2 focus:ring-second-color focus:ring-offset-2">
                        <i class="fa-solid fa-cart-shopping"></i>
                        Add to Cart
                    </button>
                    <button
                      (click)="toggleFavorite(product.id)"
                      class="bg-gray-200 flex gap-2 items-center text-gray-800 px-6 py-2 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2">
                      <i
                        [ngClass]="product.isFavorite===true ? 'fa-solid':'fa-regular'"
                        class="fa-heart text-md"></i>
                      Wishlist
                    </button>
                    <button class="bg-gray-200 flex gap-2 items-center text-gray-800 px-6 py-2 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2">
                      <i class="fa-solid fa-code-compare"></i>
                      Compare
                    </button>
                </div>
            </div>
        </div>
    </div>